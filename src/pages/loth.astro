---
import BaseHead from '../components/BaseHead.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../consts';
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
  </head>
  <body>
    <Header />
    <iframe 
  src="/pdfjs/web/viewer.html?file=/pdfs/Syro-Malabar-Liturgy-of-the-Hours.pdf" 
  width="100%" 
  height="800px" 
  style="border: none;">
</iframe>
      <p>
      <div id="daily-readings"></div>
<b>Additional Assistance</b><br>
For a How-To Guide for using the above PDF, <a href="/blog/loth-guide">click here</a> <br>
For a list of tunes you can use when using the above PDF, <a href="/blog/loth-tunes">click here</a> <br>
For a brief look into what are the liturgies of the hours, <a href="/blog/loth">click here</a>  <br>
      </p>
      <script>
function getTomorrowDateString() {
  const tomorrow = new Date();
  if (tomorrow.getHours() >= 6) {
  tomorrow.setDate(tomorrow.getDate() + 1);
  }
  const day = String(tomorrow.getDate()).padStart(2, '0');
  const month = String(tomorrow.getMonth() + 1).padStart(2, '0');
  const year = tomorrow.getFullYear();
  return `${day}-${month}-${year}`;
}

function renderDailyReadings(data) {
  const set = data.Set1?.[0];
  if (!set) return;

  const day = set.DayDescription_Eng || 'Unknown Day';
  const season = set.SeasonName_Eng_Full || 'Unknown Season';
  const reading = set.Reading3_Eng || set.Reading1_Eng || 'No reading available';
  const gospel = set.ReadingGospal_Eng || 'No gospel reading available';

  const container = document.getElementById('daily-readings');
  if (!container) return;

  container.innerHTML = `
    <p><b>Liturgical Day Info</b> (Brought to you by <a href="https://syrocalendar.com/">SyroCalendar</a>) <br>
    <b>Day:</b> ${day}<br>
    <b>Season:</b> ${season}<br>
    <b>Lelya's Epistle:</b> ${reading}<br>
    <b>Ramsa's Gospel:</b> ${gospel}
    </p>
    <br>
  `;
}

function fetchDailyReadings() {
  const dateStr = getTomorrowDateString();
  const url = `https://syrocalendar.com/SyroMalabarCalendar/?Mode=JSON&Type=DailyReadings&Date=${dateStr}`;

  fetch(url)
    .then(res => {
      if (!res.ok) throw new Error(`HTTP error: ${res.status}`);
      return res.json();
    })
    .then(data => {
      renderDailyReadings(data);
    })
    .catch(err => console.error("Error fetching readings:", err));
}

document.addEventListener('DOMContentLoaded', fetchDailyReadings);
</script>
    </main>
    <Footer />
  </body>
</html>